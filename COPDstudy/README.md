# COPD Study Metabolomics Analysis

This repository contains code and notebooks for metabolomics analysis of the COPDGene and SPIROMICS studies. It includes interactive notebooks for data wrangling, preprocessing, and analysis of metabolomics data related to Chronic Obstructive Pulmonary Disease (COPD).

## Table of Contents

- [Introduction](#introduction)
- [Project Structure](#project-structure)
- [Getting Started](#getting-started)
- [Usage](#usage)
- [Data](#data)
- [Results](#results)
- [Dependencies](#dependencies)

## Introduction

The goal of this project is to analyze metabolomics data from the COPDGene and SPIROMICS studies to gain insights into the metabolic alterations associated with Sex. This repository provides a set of tools and notebooks for preprocessing, analyzing, and visualizing the metabolomics data.

## Project Structure

- **interactive/**
  - [copdgene_spiromics_analysis.jl](https://rawcdn.githack.com/senresearch/mlm-metabolomics-supplement/b25ea655379fcdb3bccc39568b1129ad6a5eaa29/COPDstudy/interactive/copdgene_spiromics_analysis.html): Interactive Pluto notebook to run the metabolomics analysis.

- **notebooks/**
  - **preprocessing/**
    - [WranglingCOPDGene.ipynb](https://github.com/senresearch/mlm-metabolomics-supplement/blob/main/COPDstudy/notebooks/preprocessing/WranglingCOPDGene.ipynb): Notebook that carries out the data wrangling process for the COPDGene metabolomics data.
    - [WranglingSPIROMICS.ipynb](https://github.com/senresearch/mlm-metabolomics-supplement/blob/main/COPDstudy/notebooks/preprocessing/WranglingSPIROMICS.ipynb): Notebook that carries out the data wrangling process for the SPIROMICS metabolomics data.
    - [PreprocessingCOPDGene.ipynb](https://github.com/senresearch/mlm-metabolomics-supplement/blob/main/COPDstudy/notebooks/preprocessing/PreprocessingCOPDGene.ipynb): Notebook that carries out the preprocessing steps for the COPDGene metabolomics data.
    - [PreprocessingSPIROMICS.ipynb](https://github.com/senresearch/mlm-metabolomics-supplement/blob/main/COPDstudy/notebooks/preprocessing/PreprocessingSPIROMICS.ipynb): Notebook that carries out the preprocessing steps for the SPIROMICS metabolomics data.

- **src/**: Source code containing functions for preprocessing and analysis.

- **data/**
  - **processed/**: Directory for processed data files (after running the wrangling and preprocessing notebooks).

- **images/**: Directory for output images generated by the analysis.

## Getting Started

### Prerequisites

- **Julia**: Required for running the Pluto notebook.
- **R**: Required for running some function in the Jupyter notebooks.

### Installation

Clone the repository:

```bash
git clone https://github.com/senresearch/mlm-metabolomics-supplement.git
cd mlm-metabolomics-supplement/COPDstudy
```

Install the required Julia packages for the Jupyter notebooks (*Note:Pluto notebooks environment is self-contained*):

```bash
using Pkg()
Pkg.activate(".")
Pkg.instantiate()
```

## Usage

### Data Wrangling and Preprocessing

1. **Place Raw Data**: Add your raw metabolomics data to the appropriate directory.

2. **Run Wrangling Notebooks**:
   - [`WranglingCOPDGene.ipynb`](https://github.com/senresearch/mlm-metabolomics-supplement/blob/main/COPDstudy/notebooks/preprocessing/WranglingCOPDGene.ipynb)
   - [`WranglingSPIROMICS.ipynb`](https://github.com/senresearch/mlm-metabolomics-supplement/blob/main/COPDstudy/notebooks/preprocessing/WranglingSPIROMICS.ipynb)

3. **Run Preprocessing Notebooks**:
   - [`PreprocessingCOPDGene.ipynb`](https://github.com/senresearch/mlm-metabolomics-supplement/blob/main/COPDstudy/notebooks/preprocessing/PreprocessingCOPDGene.ipynb)
   - [`PreprocessingSPIROMICS.ipynb`](https://github.com/senresearch/mlm-metabolomics-supplement/blob/main/COPDstudy/notebooks/preprocessing/PreprocessingSPIROMICS.ipynb)

### Metabolomics Analysis

To perform the metabolomics analysis using the interactive Pluto notebook:

1. **Start Julia and Install Pluto**:

   ```julia
   julia
   ]

   add Pluto
   using Pluto
   Pluto.run()
   ```

2. **Open Notebook**: In your web browser, navigate to `interactive/copdgene_spiromics_analysis.jl`.

## Data

The processed data will be saved in the `data/processed/` directory after running the preprocessing notebooks.

**Note**: The `data/processed/` directory is empty by default and will contain the processed data files after running the notebooks.

## Results

All output images and figures generated during the analysis will be saved in the `images/` directory.

## Dependencies

The file `Project.toml` contains the list of the Julia packages necessary to run the Jfunctions and Jupyter notebooks.
